```{r global_options, include=FALSE}
library(knitr)
opts_chunk$set(fig.align="center", fig.height=4, fig.width=4)
```
###SDS348/385 Discussion 1: R review
**Jan 21, 2015**
<br><br>

This discussion session reviews some of the basic concepts in R you should have encountered in Biostatistics (SDS328M). For this review, we'll use two of R's built-in datasets: ToothGrowth and DNase.

To begin, load the "ToothGrowth" dataset.
```{r}
data(ToothGrowth)

# Have a look at the data frame with the head() function
head(ToothGrowth)
```

This dataset contains a single numeric variable, "len" (the guinea pig tooth length), and two categorical variables, "supp" (supplement OJ or VC) and "dose" (the dosage, given in 3 levels of 0.5, 1, and 2 mg). Note that "dose" column might also be considered numeric, depending on the particular question. For now, let's consider it to be categorical, essentially as three treatment levels.
For a more comprehensive description of this dataset, you can use the `?` symbol, as you would do for a function:
```{r}
# Pull up the help window with an in-depth description
?ToothGrowth
```

####Statistical testing

First, let's perform a simple statistical analysis to answer the question, "Did guinea pigs fed vitamin C exhibit the same tooth lengths as did the guinea pigs fed orange juice?". This question involves analyzing two groups of a single numeric variable - so, we should perform a two-sample t-test, and we will use *logical indexing* to select the VC-fed and the OJ-fed rows
```{r}
# Remember to use double equals sign (==) for logical indexing!
t.test(ToothGrowth$len[ToothGrowth$supp == "OJ"], ToothGrowth$len[ToothGrowth$supp == "VC"])
```

The results of this t-test indicate that there is no significant difference between tooth lengths for guinea pigs fed vitamin C and orange juice, and we can't reject the null hypothesis that these two groups have different tooth lengths.

####Plotting

#####Plotting categorical data 

Next, let's create some plots from this data. As you hopefully recall, certain plots (namely barplots) are used to plot *categorical data*, and other types of plots (e.g. histograms and boxplots) are used to plot *numeric data*.

First, let's create a barplot displaying *counts* for the number of guinea pigs fed vitamin C and orange juice. 
```{r}

# First, create a table containing counts for each level of the variable
supp_table <- table(ToothGrowth$supp)
supp_table

# Plot the table with a title, x-axis label, y-axis label, and a custom color
barplot(supp_table, main = "Guinea pig supplementation", xlab = "Treatment", ylab = "Count", col = "mediumseagreen")
```

#####Plotting numeric data

Next, we'll plot this dataset's numeric variable, len, using both a histogram and boxplot.
```{r}
# Histogram. Remove any title by specifying "" for main().
hist(ToothGrowth$len, main = "", xlab = "Tooth Lengths (mm)", col = "lightsteelblue1")

# Boxplot
boxplot(ToothGrowth$len, main = "", ylab = "Tooth Lengths (mm)", col = "coral2")
```

We can also create individual boxplots, within a single plotting frame, for a given numeric variable across levels of a different categorical variable.
```{r}
# Multiple boxplots in one figure using the form "numeric_variable ~ categorical_variable"
boxplot(ToothGrowth$len ~ ToothGrowth$supp, main = "", xlab = "Supplement", ylab = "Tooth Lengths (mm)", col = c("gold", "tan1"))
```

#####Plotting multiple numeric variables

Another important type of plot is the *scatterplot*, which is used to show the relationship between two numeric variables. To create a scatterplot, we'll use a different built-in dataset, "DNase," as the ToothGrowth dataset contains only a single numeric variable.
```{r}
# Load and examine dataset
data(DNAse)
head(DNase)
levels(DNase$Run)
```

First, let's plot the density vs. the concentration.
```{r}
# Scatterplot with solid circle points
plot(DNase$conc, DNase$density, xlab = "Protein concentration", ylab = "Optical density", pch = 20)
```

In this plot, we see that concentration and density seem to be positively correlated, although their relationship is not linear.

This dataset actually contains 10 replicates (variable "Run") of an ELISA assay. One useful way to display these different assays in a single scatterplot is to color points from different runs different colors. Here, we'll just plot points from runs 1, 2, and 3.
```{r}
# Plot points from Run 1
plot(DNase$conc[DNase$Run == "1"], DNase$density[DNase$Run == "1"], xlab = "Protein concentration", ylab = "Optical density", pch = 20, col = "midnightblue")

# Use the function "points" to add points to an existing plot
points(DNase$conc[DNase$Run == "2"], DNase$density[DNase$Run == "2"], pch = 20, col = "mediumorchid3")
points(DNase$conc[DNase$Run == "3"], DNase$density[DNase$Run == "3"], pch = 20, col = "darksalmon")


# Use the (extremely tedious!!! :( ) function "legend" to add a legend to distinguish points
legend("bottomright", pch = 20, c("Run 1", "Run 2", "Run 3"), col = c("midnightblue", "mediumorchid3", "darksalmon"))
```

Overall, this plot shows us that, although runs 1-3 have some differences, the differences are likely the result of random noise, and each replicate follows mostly the same trend (strong positive, non-linear correlation).








